<!--
 * @Author: your name
 * @Date: 2020-05-12 08:39:47
 * @LastEditTime: 2020-05-23 08:50:41
 * @LastEditors: Please set LastEditors
 * @Description: In User Settings Edit
 * @FilePath: \systemc:\Users\yuxin\Desktop\Face mask machine monitoring system\html\productionLine.html
 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- 基础样式 -->
    <link rel="stylesheet/less" type="text/css" href="../less/base.less">
    <!-- 本页面样式 -->
    <link rel="stylesheet/less" type="text/css" href="../less/productionLine.less">
    <!-- loading样式 -->
    <link rel="stylesheet/less" type="text/css" href="../less/loading.less">
    <!-- 公共头部样式 -->
    <link rel="stylesheet/less" type="text/css" href="../less/head.less">
    <link rel="stylesheet" type="text/css" href="../img/iconfont.css">
    <!-- less -->
    <script src="../js/common/less.min.js"></script>
    <!-- echart -->
    <script src="../js/common/echarts.min.js"></script>
    <!-- jq -->
    <script src="../js/common/jquery-3.4.1.min.js"></script>
    <script src="../js/common/jsm.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->
    <!-- 公用的本地时间 -->
    <script type="text/javascript" src="../js/common/time.js"></script>
    <!-- 本页面用到的echart -->
    <script type="text/javascript" src="../js/productionLine/myEchart.js"></script>
    <!-- 获取本页图表数据 -->
    <script type="text/javascript" src="../js/productionLine/getProductionLineData.js"></script>
    <!--  -->
    <script type="text/javascript" src="../js/productionLine/click.js"></script>
    <link rel="stylesheet" type="text/css" href="../less/laydate.css">
    <!-- 导出的时间选择器必须导入这个版本的jq不然会有点问题 -->
    <script src="../js/common/jquery.min.js"></script>
    <!-- 导出的时间选择的js文件 -->
    <script type="text/javascript" src="../js/productionLine/downLaydate.js"></script>
    <!-- 导出的时间选择器的css文件 -->
    <link rel="stylesheet" type="text/css" href="../less/downLaydate.css" />
</head>

<body>
    <!-- 产线面板背景 -->
    <div class="productionLine-bgi-wrap">
        <!-- 返回首页 -->
        <i class="home-icon iconfont icon-home"><span class="return">首页</span></i>
        <!-- loading -->
        <div class="none">
            <div class="loading-bgc">
                <div class=loading-wrap>
                    <div class="loading">
                        <div class="circle circle1">
                            <span></span>
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <div class="circle circle2">
                            <span></span>
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                        <div class="circle circle3">
                            <span></span>
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                    <div class="fonst">
                        <div>loading...</div>
                    </div>
                </div>
            </div>
        </div>
        <!-- 遮罩层 -->
        <div class="black-mask-wrap">
            <!-- 历史模态框 -->
            <div class="black-mask">
                <div class="history-modal">
                    <div class="blue-head">请选择您所想查看的日期</div>
                    <div class="row">
                        <i class="date-icon iconfont icon-riqi"></i>
                        <input type="text" class="room" id="startTime" readonly>
                    </div>
                    <div class="history-confirm-btn">确定</div>
                    <div class="history-cancel-btn">取消</div>
                </div>

                <div class="down-modal">
                    <div class="blue-head down-title">请选择您所想导出的时间段(仅支持导出近3个月数据)</div>
                    <div class="ta_date" id="div_date1">
                        <span class="date_title" id="date1"></span>
                        <div class="down-confirm-btn">确定</div>
                        <div class="down-cancel-btn">取消</div>
                    </div>
                    <!-- <div class="down-wrap">
                        <div class="row down-row-one">
                            <div class="star-title">开始时间:</div>
                            <i class="date-icon iconfont icon-riqi"></i>
                            <input type="text" class="room start-down" id="startTime" readonly>
                        </div>
                        <div class="row down-row-two">
                            <div class="end-title">结束时间:</div>
                            <i class="date-icon iconfont icon-riqi"></i>
                            <input type="text" class="room end-down" id="startTime" readonly>
                        </div>
                        <div class="down-confirm-btn">确定</div>
                    </div> -->
                </div>
            </div>
        </div>
        <!-- 公共head解构代码放于head.js -->
        <div class="head-wrap">
        </div>
        <!-- 1837 950 -->
        <!-- 头部以下的主体 -->
        <div class="productionLine-main-wrap">
            <!-- 1787 870 -->
            <!-- 1787 451 -->
            <!-- 主体上半部分 -->
            <div class="productionLine-main-top-wrap">
                <!-- 设备稼动率图表盒子 -->
                <div class="productionLine-equipment-chart-wrap">
                    <!-- 466 446 -->
                    <!-- 设备稼动率图表标题 -->
                    <div class="productionLine-equipment-chart-title bold">设备稼动率</div>
                    <!-- 设备稼动率图例 -->
                    <div class="legend-wrap">
                        <div class="legend">
                            <div class="run">
                                <p>运行时间</p>
                                <div class="skyblue"></div>
                            </div>
                            <div class="stop">
                                <p>停机时间</p>
                                <div class="blue"></div>
                            </div>
                        </div>
                    </div>
                    <!-- 设备稼动率图表 -->
                    <div class="productionLine-equipment-chart"></div>
                </div>
                <!-- 生产数量图表盒子 -->
                <!-- 746 -->
                <div class="productionLine-outPut-wrap">
                    <div class="productionLine-outPut-title bold">口罩生产数量</div>
                    <div class="productionLine-outPut-num-wrap">
                        <div class="productionLine-name">KN95</div>
                        <span class="totalQty">2689205</span>
                        <i>个</i>
                    </div>
                </div>
                <!-- 单位产量 -->
                <div class="productionLine-perUnitOutput-chart-wrap">
                    <!-- 466 446 -->
                    <!-- 设备稼动率图表标题 -->
                    <div class="productionLine-perUnitOutput-chart-title bold">单位产量</div>
                    <!-- 设备稼动率图表 -->
                    <div class="productionLine-perUnitOutput-chart"></div>
                    <!-- <div class="gauge-label-wrap">
                        KN95
                    </div> -->
                </div>
            </div>
            <!-- 主体的下半部分 -->
            <div class="productionLine-main-bottom-wrap">
                <!-- 每小时产量图表 -->
                <div class="productionLine-hourly-output"></div>
                <!-- 164 36 -->
                <!-- 导出按钮 -->
                <div class="export-btn"><i class="iconfont icon-daochu"></i> 导出</div>
                <!-- 历史按钮 -->
                <div class="history-btn"><i class="iconfont icon-lishijilu"></i>历史</div>
            </div>
        </div>
    </div>
    <!-- 公共头部的html -->
    <script type="text/javascript" src="../js/common/head.js"></script>
    <!-- 历史日期选择器 -->
    <script type="text/javascript" src="../js/productionLine/laydate.js"></script>
    <!-- 导出的日期选择的配置文件 -->
    <script type="text/javascript" src="../js/productionLine/downLaydateConfig.js"></script>
    <script>
        $(function () {
            $.loaded = false;
             // 获取当前时间
             getNowTime();
            // 初始化产线的图表数据
            initProductionLineEcharts();
            // 导出的日期选择插件的配置项文件
            downLaydateConfig();
            // 产线页面的所有点击事件
            productionLineClick();
            //请求数据
            var ws = new JSM.WS();
            //  获取?后面的参数
            var url = location.search;
            //  切取为数组[?ch,0&type,0]
            var num = url.split('=');
            //  获取ch
            var ch = parseInt(num[1]);
            //  获取type
            var type = num[2];
            console.log(num[2]);
            type == 0 ? $(".productionLine-name").text(`KN95 产线${ch-3}`) : $(".productionLine-name").text(`平面 产线${ch}`);
            ws.init({
                url: `192.168.10.128:8000/line/?ch=${ch}&u=2&ts=1588956972&token=AAABBBCCC&data=debug`
            });
            ws.connect()
                .receive(setProduvtionLineValue)

                //{type: 'error', state: 0, message: 'msg'}
                .error(function (evt) {
                    console.log("ERROR::" + evt.message)
                });


            setInterval(function () {
                ws.send(`LINEON:${ch}`);
            }, 3000);
           
        })
    </script>
</body>

</html>